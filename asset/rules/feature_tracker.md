## TODO
- [ ] * 网络（网络断连时处理）
- [ ] * 设置页面
- [ ] 更复杂的移动逻辑（路径可达性检验）
- [ ] Card视觉效果优化, Shortcut...
- [ ] 谁的击沉区？谁的回合？
- [ ] 一个舰种的多种精灵图

## BUGS
- [ ] 鱼雷飞机，判定
- [ ] 移动撤回视觉优化
- [ ] 补给船C&布雷艇ML：在基地周围被敌方棋子占用仍然生成。
- [x] CV 一局能派多架飞机
- [x] 点亮后显示鱼雷值
- [ ] ActionButton 抢夺鼠标焦点

对局胜利条件为击沉对方全部船只，或在对方部署区无船只的情况下有己方棋子处于对方基地周围一圈格子内三回合。
## 船只
（1），船只信息概述
船只分为下述类别，图标和机制各有不同，详细运算规则见各作战环节说明。
- [x] 每种船只有四项数据，从左到右依次为，生命值，机动性，防空值，雷击值。
- [x] 生命值：即血量，归零时视为击沉，从棋盘上移除该船只，
- [x] 放入棋盘旁边指定的击毁单位区域。
- [x] 机动性：即每个行动回合船只可以移动的最大距离。
- [x] 防空值：进行补正运算（详见后文）。
- [x] 雷击值：决定该船只可以进行雷击的剩余次数，可用补给船刷新。

（2），船只种类
I 作战船只：对局开始前部署
驱逐舰DD：多功能的小型船只
轻巡洋舰CL：有一定火力和航速的中型船只
重巡洋舰CA：有一定装甲和火力的大型船只
战列舰BB：有重型装甲和火炮的大型船只
航空母舰CV：能够进行航空作业的大型船只
  - [x] DD，CL的防空值可与自身距离为1的单位相互叠加，其余单位仅对自身所在格生效

 | NAME | HP | MOT | AIR | TOR |
 |------|----|-----|-----|-----|
 | DD   | 2  | 4   | 3   | 3   |
 | CL   | 4  | 3   | 4   | 2   |
 | CA   | 6  | 3   | 3   | 0   |
 | BB   | 10 | 2   | 1   | 0   |
 | CV   | 6  | 3   | 1   | 0   |

II 特殊船只：生命值均为1，根据特殊规则部署

- [x] 潜艇SS：对局开始前部署共两艘在双方中央的不属于任何一方的区域
- [x] 补给船C：第二回合后每回合可在基地周围额外部署至多一艘
- [x] 布雷艇ML：第二回合后总共可在基地周围额外部署至多一艘
- [ ] 补给船C&布雷艇ML：在基地周围被占用时不生成

 | NAME | HP | MOT | AIR | TOR |
 |------|----|-----|-----|-----|
 | SS   | 1  | *   | 0   | 3   |
 | C    | 1  | 3   | 0   | 0   |
 | ML   | 1  | 2   | 0   | 0   |

## 开局前部署规则
开局前双方可选择一定数量的船只部署，遵循以下规则：
- [x] 总cost不超过20
- [x] DD不超过8，BB不超过4，CV不超过2



## 作战说明
1. ### 补给回合
   - [x] 该回合仅可以移动C，ML
   - [x] 对于C：仅限一次，可恢复其附近距离为1的友方单位生命值至最大值的一半（向下取整），恢复雷击值至最大值，随后移除该单位，不放入击毁单位区域
   - [x] C ML 重新生成
   - [x] 对于ML：可在自身周围距离为1的格子中选择一个布雷，该格随后对己方显示水雷标志，不可进入，
   - [x] ML布雷后移除该单位，不放入击毁单位区域
   - [x] 对途径的除SS和DD外的敌方单位造成5点伤害（次数不限）
   - [x] 双方SS单位可无视该效果。
   - [x] 敌方DD在此停留时可使该格子变回普通格子。

2. ### 移动
   - [x] 双方**依次**（？？？）根据船只机动性移动，可以不移动，随后进行判定，
   - [x] 除以下例外外，每个对处于同一格子中的单位对其余该格子内的单位造成等于自身最大生命值的两倍的伤害。
	 - [x] SS在该回合不移动，且不参与判定
	 - [x] C/ML在该回合不移动，但若有单位与其重合，则将其直接移除，但不放入击毁单位区域。

3. ### 航空侦察回合
   - [x] 双方CV（如有），每个CV单位仅一次，使用舰载机对任意指定格及周边距离为4的六边形进行侦察，在该回合内点亮范围内所有敌方单位
   - [x] （SS除外）
   - [x] 点亮机制: 显示血量， 显示一回合舰种， 其余不显示。


4. ### 航空战回合
	- [x] 双方CV依次派出战斗机指定优先防空区域（指定格及周边距离为2的六边形）
	- [x] 该范围内敌方第一个来袭的攻击机将直接被击落，且对敌方CV造成1点伤害
	- [x] 双方CV选择 鱼雷攻击机 或 俯冲轰炸机
	- [x] 鱼雷攻击机 对三个格子 进行攻击判定
	- [x] 俯冲轰炸机 对一个格子 进行攻击判定

	航空战判定：
	- [x] 选定攻击位置后，系统会先判定是否处于对方优先防空区域内，再判定是否存在可攻击目标并分别给出反馈。
	- [x] 进攻方投掷骰子，若点数大于等于对方防空值则进行伤害结算，若大于对方防空值一半（向上取整）且小于对方防空值则仅造成1点伤害，对进攻方CV损失一点生命值，其余情况不造成伤害，进攻方CV损失一点生命值。
	- [x] 若能够进行伤害结算，鱼雷轰炸机将对三个格子内所有目标造成3点伤害，俯冲轰炸机造成（1点+根据投出点数减去对方防空值）的伤害。

5. ### 炮击战回合
	- [x] 双方依次选择各自每艘舰船攻击的目标格，随后进行判定，其中，DD最远选择距离为2，CL为2，CA为3，BB为4，其余船只不参与炮击战，但可以被攻击。
	- [x] *炮击判定：双方选择完成后各掷骰子一次，系统记录点数，命中对方的条件为：

	| 距离 | 最小点数 |
	|------|----------|
	| 1    | 2        |
	| 2    | 3        |
	| 3/4  | 4        |

	*炮击补正运算规则：若能命中，进行判定时实际造成伤害为（1+舰种补正）。
	- [x] 舰种顺序为：ML/C/DD＜CL/CV＜CA小于BB，
	- [x] 每向上跨越一级，造成伤害减1，每向下跨越一级，造成伤害+1，同级不补正。

6. ### 雷击战
	- [x] （可主动选择跳过）
	- [x] 双方雷击值不为0的船只依次选择距离自身距离不超过4的格子进行鱼雷攻击。
	- [x] 随后投掷骰子，对该格子与船只连线直接穿过中心的格子内双方单位造成投出点数的伤害。
	- [x] 对于连线经过但不穿过中心的格子内的双方单位造成减半伤害（向下取整）。
	- [x] 若距离为1的格子经过连线，则该次攻击改为对该格内单位造成6点伤害。

7. ### 潜艇回合
	- [x] 该回合开始后，双方DD周围距离为2的SS立即点亮
	- [x] 双方DD可选择距离为1或0的格子内的至多一艘SS并直接击毁。
	- [x] 双方依次移动SS，对于未点亮的SS，最多移动距离为2，点亮的SS最多移动距离为1
	- [x] 移动完成后不进行常规移动后的判定（可以与其他单位处于同一格），随后选择最大距离为3的格子进行鱼雷攻击，判定方式见雷击战。


至此一回合结束，判定是否分出胜负，若没有则进入下一回合。
